# 재고관리 자동화 스크립트 사용 설명서

## 📁 파일 구성

```
📂 작업 폴더/
├── 재고관리.xlsx                    # 원본 재고관리 파일
├── update_joheung_inventory.py     # Python 자동화 스크립트
├── 재고관리_업데이트.bat             # 실행 배치 파일 (더블클릭용)
└── README.md                        # 이 파일
```

---

## 🚀 빠른 시작 가이드

### 1단계: 파일 준비
1. `update_joheung_inventory.py` 파일을 `재고관리.xlsx`와 **같은 폴더**에 복사
2. `재고관리_업데이트.bat` 파일도 같은 폴더에 복사

### 2단계: Python 설치 확인
- Python이 설치되어 있지 않다면:
  - https://www.python.org/downloads/ 에서 다운로드
  - 설치 시 **"Add Python to PATH"** 체크 필수!

### 3단계: 매일 사용법

#### 방법 1: 배치 파일 사용 (추천) ⭐
```
1. 사내 시스템에서 raw data 다운로드
2. 재고관리.xlsx에 새 시트로 추가 (예: 0123, 0124...)
3. "재고관리_업데이트.bat" 파일 더블클릭
4. 완료!
```

#### 방법 2: Python 직접 실행
```cmd
# 명령 프롬프트에서
python update_joheung_inventory.py
```

---

## 📋 스크립트가 하는 일

1. ✅ 재고관리.xlsx 파일 열기
2. ✅ 최신 날짜 시트 자동 찾기 (0109, 0122 등)
3. ✅ 공급처코드 20001787 (조흥지에프) 데이터 필터링
4. ✅ "조흥" 시트에 자동 업데이트:
   - 당월 판매량
   - 전월 판매량
   - 전전월 판매량
   - 재고 (합계)
   - 현재고 (출고가능량)
5. ✅ 백업 파일 자동 생성
6. ✅ 업데이트 로그 기록

---

## 🔍 업데이트 확인 방법

### 실행 화면 확인
```
================================
재고관리 자동화 스크립트 시작
================================
[2025-01-23 10:30:15] 파일 열기: C:\Users\Lucy\재고관리.xlsx
[2025-01-23 10:30:16] 최신 시트 발견: 0122 (01월 22일)
[2025-01-23 10:30:17] ✓ 15개 품목 데이터 추출 완료
[2025-01-23 10:30:18] ✓ 15개 품목 업데이트 완료
[2025-01-23 10:30:19] ✓ 파일 저장 완료
================================
✓ 모든 작업 완료!
================================
```

### 백업 파일 확인
- 자동 생성된 백업 파일: `재고관리_backup_20250123_103019.xlsx`
- 혹시 문제가 생기면 백업 파일로 복원 가능

### 로그 파일 확인
- 생성 위치: `update_log_20250123.txt`
- 매일 업데이트 내역이 누적 기록됨

---

## ⚠️ 주의사항

### 1. 시트 이름 규칙
- Raw data 시트는 **반드시 MMDD 형식**으로 생성
- ✅ 올바른 예: `0109`, `0122`, `0131`
- ❌ 잘못된 예: `1-9`, `Jan09`, `20250109`

### 2. 데이터 검증
- 스크립트 실행 후 **조흥 시트 확인** 필수
- 특히 첫 사용 시에는 샘플 데이터 비교 확인

### 3. 백업
- 백업 파일은 주기적으로 정리 (1주일 이상 된 파일)
- 중요한 시점의 백업은 별도 보관

### 4. 신규 품목
- Raw data에만 있고 조흥 시트에 없는 품목은 자동 추가되지 않음
- 로그에 신규 품목 목록이 표시됨 → 수동 추가 필요

---

## 🐛 문제 해결

### 문제: "파일을 찾을 수 없습니다"
**원인**: 스크립트와 엑셀 파일이 다른 폴더에 있음  
**해결**: 두 파일을 같은 폴더에 배치

### 문제: "Python이 설치되어 있지 않습니다"
**원인**: Python 미설치 또는 PATH 설정 안됨  
**해결**: 
1. Python 재설치
2. 설치 시 "Add Python to PATH" 체크
3. 컴퓨터 재시작

### 문제: "모듈을 찾을 수 없습니다 (openpyxl, pandas)"
**원인**: 필요한 라이브러리 미설치  
**해결**:
```cmd
pip install openpyxl pandas
```

### 문제: "날짜 형식의 시트를 찾을 수 없습니다"
**원인**: MMDD 형식의 시트가 없음  
**해결**: Raw data 시트 이름을 `0123` 형식으로 변경

### 문제: "공급처코드 데이터를 찾을 수 없습니다"
**원인**: 해당 날짜 시트에 조흥지에프 데이터가 없음  
**해결**: Raw data 확인 및 시트 선택 확인

---

## 📊 고급 사용법

### 특정 파일 경로 지정
```cmd
python update_joheung_inventory.py "D:\문서\재고관리.xlsx"
```

### 백업 없이 실행 (코드 수정 필요)
```python
# update_joheung_inventory.py 파일에서
self.save_file(backup=False)  # backup=True를 False로 변경
```

### 여러 공급처 처리 (향후 확장)
- 현재는 조흥지에프(20001787)만 처리
- 다른 공급처 추가 시 코드 수정 필요

---

## 📞 문의 및 지원

문제가 발생하거나 개선사항이 있으면:
1. `update_log_[날짜].txt` 파일 확인
2. 오류 메시지 캡처
3. IT 지원팀에 문의

---

## 📝 업데이트 이력

### v1.0 (2025-01-23)
- 초기 버전 배포
- 조흥지에프 자동 업데이트 기능
- 백업 및 로그 기능

---

**Happy Automation! 🎉**

더 이상 수동 복사/붙여넣기는 없습니다!
